<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cooking Assistant</title>
  <link rel="stylesheet" href="/styles/reset.css">
  <link rel="stylesheet" href="/styles/page.css" />
  <link rel="stylesheet" href="/styles/tokens.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- <link href="https://fonts.googleapis.com/css2?family=Poetsen+One&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Poetsen+One&display=swap" rel="stylesheet"> -->
  <link href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Poetsen+One&family=Rowdies:wght@300;400;700&display=swap" rel="stylesheet">
</head>

<body>
  <mu-auth provides="cooking:auth">
    <cook-header></cook-header>
  <!-- <header>
    <div class="title-with-icon">
      <h1>Cooking Assistant</h1>
      <svg class="icon">
        <use href="/icons/food.svg#icon-bell" />
      </svg>
    </div>
    <label class="toggle-switch">
      <input type="checkbox" id="dark-mode-toggle" autocomplete="off">
      <span class="slider"></span>
    </label>
  </header> -->

  <div id="layout">
    <!-- <div id="sidebar">
      <h2>History</h2>
      <ul>
        <li><a href="history_record.html">Tomato + Egg</a></li>
        <li><a href="history_record.html">Chicken + Mushroom</a></li>
        <li><a href="history_record.html">Beef + Broccoli</a></li>
      </ul>
    </div> -->
    <div id="sidebar">
      <h2>History</h2>
      <ul>
        <!-- <cook-history-item href="history_record.html">Tomato + Egg</cook-history-item> 
        <cook-history-item href="history_record.html">Chicken + Mushroom</cook-history-item> 
        <cook-history-item href="history_record.html">Beef + Broccoli</cook-history-item>  -->
        <cook-history-list src="/data/history.json"></cook-history-list> 
      </ul>
    </div>

    <div id="main">
      <div id="ingredients-input">
        
        <!-- <h1>Enter Ingredients
          <svg class="icon">
            <use href="/icons/food.svg#icon-fork" />
          </svg>
        </h1> -->
        <div class="section-title-with-icon">
          <h1>Enter Ingredients</h1>
          <svg class="icon-small">
            <use href="/icons/food.svg#icon-fork" />
          </svg>
        </div>
        <div class="input-row">
          <input type="text" placeholder="e.g., chicken, tomato">
        </div>
        <!-- <input type="text" placeholder="e.g., chicken, tomato"> -->
        <p><a href="query.html">Submit Ingredients</a></p>
      </div>

      <div id="recipe-suggestion">
        <h2>Suggested Recipe</h2>
        <p>Recipe will appear here after search.</p>
      </div>

      <div id="recipe-steps">
        <h2>Recipe Steps</h2>
        <!-- <ol>
          <li>Wash and chop ingredients.</li>
          <li>Heat oil in a pan.</li>
          <li>Add ingredients and stir-fry.</li>
          <li>Season to taste and serve hot.</li>
        </ol> -->
        <ol>
          <cook-step><span slot="step">Wash and chop ingredients.</span></cook-step>
          <cook-step><span slot="step">Heat oil in a pan.</span></cook-step>
          <cook-step><span slot="step">Add ingredients and stir-fry.</span></cook-step>
          <cook-step><span slot="step">Season to taste and serve hot.</span></cook-step>
        </ol>
      </div>

      <div id="bottom">
        <h2>Feedback</h2>
        <label for="rating">Rate this recipe:</label>
        <input type="range" id="rating" name="rating" min="1" max="5" step="1">
        <span>3/5</span>
      </div>
    </div>
  </div>
  </mu-auth>
</body>

<script type="module">
  import { define, Auth } from "@calpoly/mustang";
  import { HistoryItemElement } from "/src/history-item.js"; 
  import { CookStepElement } from "/src/cook-step.js";
  import { HistoryListElement } from "/src/history-list.js"; 
  import { CookHeaderElement } from "/src/cook-header.ts";

  document.addEventListener('DOMContentLoaded', (event) => { 

    const label = document.getElementById("dark-mode-toggle");

    if (label) { 
      label.onchange = (event) => {
        const checked = event.target.checked;

        const customEvent = new CustomEvent("darkmode:toggle", {
          bubbles: true,
          detail: { checked },
        });

        label.dispatchEvent(customEvent);
      };
    } else {
      console.error("Dark mode toggle element not found!"); 
    }

    document.body.addEventListener("darkmode:toggle", (event) => {
      if (event.detail && typeof event.detail.checked !== 'undefined') {
        document.body.classList.toggle("dark-mode", event.detail.checked);
      } else {
        console.error("Dark mode toggle event received without detail.checked");
      }
    });

  }); 
  define({ 
  "cook-history-item": HistoryItemElement,
  "cook-step": CookStepElement,
  "cook-history-list": HistoryListElement,
  "cook-header":        CookHeaderElement, 
  "mu-auth":            Auth.Provider
}); 
</script>
</html>
